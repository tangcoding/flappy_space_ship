!function t(e,s,i){function n(c,p){if(!s[c]){if(!e[c]){var r="function"==typeof require&&require;if(!p&&r)return r(c,!0);if(o)return o(c,!0);var a=new Error("Cannot find module '"+c+"'");throw a.code="MODULE_NOT_FOUND",a}var l=s[c]={exports:{}};e[c][0].call(l.exports,function(t){var s=e[c][1][t];return n(s?s:t)},l,l.exports,t,e,s,i)}return s[c].exports}for(var o="function"==typeof require&&require,c=0;c<i.length;c++)n(i[c]);return n}({1:[function(t,e,s){var i=function(t,e){this.entity=t,this.radius=e,this.type="circle"};i.prototype.collidesWith=function(t){return"circle"==t.components.collision.type?this.collideCircle(t):"rect"==t.components.collision.type?this.collideRect(t):!1},i.prototype.collideCircle=function(t){var e=this.entity.components.physics.position,s=t.components.physics.position,i=this.radius,n=t.components.collision.radius,o={x:e.x-s.x,y:e.y-s.y},c=o.x*o.x+o.y*o.y,p=i+n;return p*p>1.04*c},i.prototype.collideRect=function(t){var e=function(t,e,s){return e>t?e:t>s?s:t},s=this.entity.components.physics.position,i=t.components.physics.position,n=t.components.collision.size,o={x:e(s.x,i.x,i.x+n.x),y:e(s.y,i.y,i.y+n.y)},c=this.radius,p={x:s.x-o.x,y:s.y-o.y},r=p.x*p.x+p.y*p.y;return c*c>1.04*r},s.CircleCollisionComponent=i},{}],2:[function(t,e,s){var i=function(t,e){this.entity=t,this.size=e,this.type="rect"};i.prototype.collidesWith=function(t){return"circle"==t.components.collision.type?this.collideCircle(t):"rect"==t.components.collision.type?this.collideRect(t):!1},i.prototype.collideCircle=function(t){return t.components.collision.collideRect(this.entity)},i.prototype.collideRect=function(t){var e=this.entity.components.physics.position,s=t.components.physics.position,i=this.size,n=t.components.collision.size,o=e.x,c=e.x+i.x,p=e.y,r=e.y+i.y,a=s.x,l=s.x+n.x,h=s.y,y=s.y+n.y;return!(o>l||a>c||p>y||h>r)},s.RectCollisionComponent=i},{}],3:[function(t,e,s){var i=function(t){this.entity=t};i.prototype.draw=function(t){var e=this.entity.components.physics.position,s=this.entity.components.physics.size;t.save();var i=document.getElementById("bird");t.drawImage(i,e.x,e.y,s.x,s.y),t.restore()},s.BirdGraphicsComponent=i},{}],4:[function(t,e,s){var i=function(t){this.entity=t};i.prototype.draw=function(t){var e=this.entity.components.physics.position,s=this.entity.components.physics.radius;t.save();var i=document.getElementById("level").innerHTML;i=parseInt(i),i%3==1?img=document.getElementById("rock1"):i%3==2?img=document.getElementById("rock2"):img=document.getElementById("rock3"),t.drawImage(img,e.x-s,e.y-s,2*s,2*s),t.restore()},s.PipeGraphicsComponent=i},{}],5:[function(t,e,s){var i=function(t){this.entity=t};i.prototype.draw=function(t){var e=this.entity.components.physics.position,s=this.entity.components.physics.radius;t.save();var i=document.getElementById("star");t.drawImage(i,e.x-s,e.y-s,2*s,2*s),t.restore()},s.StarGraphicsComponent=i},{}],6:[function(t,e,s){var i=function(t){this.entity=t,this.type="rect",this.status="still",this.level=1,this.max_level=1,this.pass_pipe_num=0,this.rest_pipe_num=!1,this.base=0,this.size={x:.07,y:.07},this.position={x:0,y:0},this.velocity={x:0,y:0},this.acceleration={x:0,y:-1.5}};i.prototype.update=function(t){this.velocity.y+=this.acceleration.y*t,this.position.y+=this.velocity.y*t},s.PhysicsComponent=i},{}],7:[function(t,e,s){var i=function(t){this.entity=t,this.name="pipe",this.type="circle",this.pass=!1,this.radius=.5,this.position={x:.5,y:0},this.velocity={x:-.22,y:0}};i.prototype.update=function(t){this.position.x+=this.velocity.x*t},s.PhysicsComponent=i},{}],8:[function(t,e,s){var i=function(t){this.entity=t,this.name="star",this.type="circle",this.pick=!1,this.radius=.01,this.position={x:.5,y:0},this.velocity={x:-.22,y:0}};i.prototype.update=function(t){this.position.x+=this.velocity.x*t},s.PhysicsComponent=i},{}],9:[function(t,e,s){var i=t("../components/graphics/bird"),n=t("../components/physics/bird_physics"),o=t("../components/collision/rect"),c=function(){var t=new n.PhysicsComponent(this);t.position.y=.5;var e=new i.BirdGraphicsComponent(this),s=new o.RectCollisionComponent(this,t.size);s.onCollision=this.onCollision.bind(this),this.components={physics:t,graphics:e,collision:s}};c.prototype.onCollision=function(t){},s.Bird=c},{"../components/collision/rect":2,"../components/graphics/bird":3,"../components/physics/bird_physics":6}],10:[function(t,e,s){var i=t("../components/graphics/pipe"),n=t("../components/physics/pipe_physics"),o=t("../components/collision/circle"),c=function(t,e){var s=new n.PhysicsComponent(this);s.position.y=t,s.radius=e;var c=new i.PipeGraphicsComponent(this),p=new o.CircleCollisionComponent(this,s.radius);this.components={physics:s,graphics:c,collision:p}};s.Pipe=c},{"../components/collision/circle":1,"../components/graphics/pipe":4,"../components/physics/pipe_physics":7}],11:[function(t,e,s){var i=t("../components/graphics/star"),n=t("../components/physics/star_physics"),o=t("../components/collision/circle"),c=function(t){var e=new n.PhysicsComponent(this);e.position.y=t;var s=new i.StarGraphicsComponent(this),c=new o.CircleCollisionComponent(this,e.radius);this.components={physics:e,graphics:s,collision:c}};s.Star=c},{"../components/collision/circle":1,"../components/graphics/star":5,"../components/physics/star_physics":8}],12:[function(t,e,s){var i=t("./systems/graphics"),n=t("./systems/physics"),o=t("./systems/input"),c=t("./entities/bird"),p=function(){this.entities=[new c.Bird],this.graphics=new i.GraphicsSystem(this.entities),this.physics=new n.PhysicsSystem(this.entities),this.input=new o.InputSystem(this.entities)};p.prototype.run=function(){this.graphics.run(),this.physics.run(),this.input.run()},s.FlappyBird=p},{"./entities/bird":9,"./systems/graphics":15,"./systems/input":16,"./systems/physics":17}],13:[function(t,e,s){var i=t("./flappy_bird");document.addEventListener("DOMContentLoaded",function(){var t=new i.FlappyBird;t.run()})},{"./flappy_bird":12}],14:[function(t,e,s){var i=t("./storage_localstorage"),n=function(t){this.entities=t,this.end_game=!1,this.storageSystem=new i.StorageSystem(t)};n.prototype.tick=function(){this.end_game=!1;var t=this.entities[0];(t.components.physics.position.y<0||t.components.physics.position.y>1)&&(this.end_game=!0);for(var e=null,s=1;s<this.entities.length&&!this.end_game;s++){var i=this.entities[s];if(!(!1 in t.components))if(t.components.collision.collidesWith(i))"pipe"==i.components.physics.name?this.end_game=!0:"star"!=i.components.physics.name||i.components.physics.pick||(i.components.physics.pick=!0,e=s,document.getElementById("score").innerHTML+="&star;");else if("pipe"==i.components.physics.name&&!i.components.physics.pass&&i.components.physics.position.x+i.components.physics.radius<t.components.physics.position.x&&(i.components.physics.pass=!0,t.components.physics.pass_pipe_num+=1,t.components.physics.pass_pipe_num>=20)){this.end_game=!0;break}}if(null!=e&&this.entities.splice(e,1),this.end_game){if(this.entities.length=1,t.components.physics.status="still",t.components.physics.reset_pipe_num=!0,t.components.physics.position.x=0,t.components.physics.position.y=.5,t.components.physics.pass_pipe_num<20)document.getElementById("result_text").innerHTML="Level Failed",document.getElementById("final_score").innerHTML="";else{document.getElementById("result_text").innerHTML="Level Complete";var n="l"+t.components.physics.level+"_star";document.getElementById("final_score").innerHTML=document.getElementById("score").innerHTML;var o=document.getElementById(n).innerHTML,c=document.getElementById("final_score").innerHTML;if(c.length>o.length&&(document.getElementById(n).innerHTML=c),t.components.physics.level+1>t.components.physics.max_level&&t.components.physics.level+1<=9){t.components.physics.max_level=t.components.physics.level+1;var n="lbtn_"+t.components.physics.max_level;document.getElementById(n).className+=" level_btn_active"}}document.getElementById("result").style.display="block",document.getElementById("score_board").style.display="none",this.storageSystem.store_score()}},s.CollisionSystem=n},{"./storage_localstorage":18}],15:[function(t,e,s){var i=t("../entities/pipe"),n=t("../entities/star"),o=function(t){this.entities=t,this.canvas=document.getElementById("main-canvas"),this.context=this.canvas.getContext("2d"),this.anim=!1,this.pipe_num=0};o.prototype.run=function(){window.setInterval(this.tick.bind(this),1e3/60),window.setInterval(this.add_pipes_star.bind(this),2e3)},o.prototype.tick=function(){(this.canvas.width!=this.canvas.offsetWidth||this.canvas.height!=this.canvas.offsetHeight)&&(this.canvas.width=this.canvas.offsetWidth,this.canvas.height=this.canvas.offsetHeight),this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.save(),this.context.translate(this.canvas.width/2,this.canvas.height),this.context.scale(this.canvas.width,-this.canvas.height);for(var t=[],e=0;e<this.entities.length;e++){var s=this.entities[e];if(!(!1 in s.components)){var i=s.components.physics.position;i.x<-.5?t.push(e):s.components.graphics.draw(this.context)}}this.context.restore();for(var e=t.length-1;e>0;e--)this.entities.splice(t[e],1)},o.prototype.add_pipes_star=function(){var t=this.entities[0].components.physics.level%3,e=this.entities[0].components.physics.reset_pipe_num;if(e&&(this.pipe_num=0,this.entities[0].components.physics.reset_pipe_num=!1),"move"==this.entities[0].components.physics.status&&this.pipe_num<20){var s=function(t,e){return Math.random()*(e-t)+t},o=s(0,.35+.03*t),c=s(.06,.16),p=s(.03,.06);p+=c+.35+.02*t;var r=s(.06,.16);if(this.entities.push(new i.Pipe(o,c)),this.entities.push(new i.Pipe(o+p,r)),this.pipe_num+=2,this.pipe_num%3==0){var a=.02+.01*t,l=o+c+a,h=s(l,l+a);this.entities.push(new n.Star(h))}}},s.GraphicsSystem=o},{"../entities/pipe":10,"../entities/star":11}],16:[function(t,e,s){var i=t("./storage_localstorage"),n=function(t){this.entities=t,this.storageSystem=new i.StorageSystem(t),this.canvas=document.getElementById("main-canvas"),this.start_btn=document.getElementById("start"),this.new_game_btn=document.getElementById("new_game"),this.pause_btn=document.getElementById("pause"),this.level_btn=document.getElementById("level_wrap"),this.prev_btn=document.getElementById("prev_page"),this.next_btn=document.getElementById("next_page")};n.prototype.run=function(){window.addEventListener("load",this.windowLoad.bind(this)),window.addEventListener("blur",this.windowBlur.bind(this)),window.addEventListener("keypress",this.keyPress.bind(this)),this.canvas.addEventListener("click",this.onClick.bind(this)),this.pause_btn.addEventListener("click",this.pauseGame.bind(this)),this.new_game_btn.addEventListener("click",this.newGame.bind(this)),this.level_btn.addEventListener("click",this.chooseLevel.bind(this)),this.prev_btn.addEventListener("click",this.prev.bind(this)),this.next_btn.addEventListener("click",this.next.bind(this))},n.prototype.onClick=function(){var t=this.entities[0];t.components.physics.velocity.y=.5},n.prototype.onTouch=function(){var t=this.entities[0];t.components.physics.velocity.y=.5},n.prototype.onGameStart=function(){document.getElementById("intro").style.display="none";var t=this.entities[0];document.getElementById("score").innerHTML="",document.getElementById("final_score").innerHTML="",document.getElementById("level").innerHTML=t.components.physics.level,t.components.physics.position.x=0,t.components.physics.position.y=.5,t.components.physics.velocity.x=.02,t.components.physics.velocity.y=0,t.components.physics.pass_pipe_num=0,t.components.physics.level%3==1?document.getElementById("main-canvas").style.backgroundColor="#104E8B":t.components.physics.level%3==2?document.getElementById("main-canvas").style.backgroundColor="#33691E":document.getElementById("main-canvas").style.backgroundColor="#827717",window.setTimeout(function(){t.components.physics.status="move"},200),document.getElementById("score_board").style.display="block"},n.prototype.newGame=function(){document.getElementById("result").style.display="none",document.getElementById("intro").style.display="block"},n.prototype.pauseGame=function(){var t=this.entities[0];"still"==t.components.physics.status?(window.setTimeout(function(){t.components.physics.status="move"},200),this.pause_btn.innerHTML="Pause"):(t.components.physics.status="still",this.pause_btn.innerHTML="Resume")},n.prototype.keyPress=function(){var t=window.event;32==t.which&&this.pauseGame()},n.prototype.windowBlur=function(){var t=this.entities[0];"move"==t.components.physics.status&&this.pauseGame()},n.prototype.chooseLevel=function(t){var e=(t||window.event,t.target||t.srcElement);"BUTTON"!=e.nodeName&&(e=e.parentElement);var s=parseInt(e.id.split("_")[1]),i=this.entities[0];s<=i.components.physics.max_level&&(i.components.physics.level=s,this.onGameStart())},n.prototype.windowLoad=function(){this.storageSystem.onload_setup()},n.prototype.prev=function(){this.entities[0].components.physics.base-=9,this.entities[0].components.physics.base<0&&(this.entities[0].components.physics.base=0),this.storageSystem.inprogress_setup()},n.prototype.next=function(){this.entities[0].components.physics.base+=9,this.storageSystem.inprogress_setup()},s.InputSystem=n},{"./storage_localstorage":18}],17:[function(t,e,s){var i=t("./collision"),n=function(t){this.entities=t,this.collisionSystem=new i.CollisionSystem(t)};n.prototype.run=function(){window.setInterval(this.tick.bind(this),1e3/60)},n.prototype.tick=function(){if("move"==this.entities[0].components.physics.status){for(var t=0;t<this.entities.length;t++){var e=this.entities[t];!1 in e.components||e.components.physics.update(1/60)}this.collisionSystem.tick()}},s.PhysicsSystem=n},{"./collision":14}],18:[function(t,e,s){var i=function(t){this.entities=t};i.prototype.support_local_storage=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(t){return!1}},i.prototype.store_score=function(){if(!this.support_local_storage)return!1;localStorage["fss.max_level"]=this.entities[0].components.physics.max_level,localStorage["fss.base"]=this.entities[0].components.physics.base;var t={};null!=localStorage["fss.level_star"]&&(t=JSON.parse(localStorage["fss.level_star"]));var e=this.entities[0].components.physics.level,s=document.getElementById("final_score").innerHTML;t[e]?s.length>t[e].length&&(t[e]=s):t[e]=s,localStorage["fss.level_star"]=JSON.stringify(t)},i.prototype.onload_setup=function(){if(!this.support_local_storage)return!1;var t=1;null!=localStorage["fss.max_level"]&&(t=parseInt(localStorage["fss.max_level"])),this.entities[0].components.physics.max_level=t;var e=0;null!=localStorage["fss.base"]&&(e=parseInt(localStorage["fss.base"])),this.entities[0].components.physics.base=e;var s={};null!=localStorage["fss.level_star"]&&(s=JSON.parse(localStorage["fss.level_star"])),this.show_score(t,e,s)},i.prototype.inprogress_setup=function(){if(!this.support_local_storage)return!1;var t=this.entities[0].components.physics.max_level;localStorage["fss.max_level"]=t;var e=this.entities[0].components.physics.base;localStorage["fss.base"]=e;var s={};null!=localStorage["fss.level_star"]&&(s=JSON.parse(localStorage["fss.level_star"])),this.show_score(t,e,s)},i.prototype.show_score=function(t,e,s){var i=document.getElementById("level_wrap");i.innerHTML="";for(var n=1;9>=n;n++){var o=n+e,c=document.createElement("button");c.className+=" level_btn",c.id="lbtn_"+o;var p="";s[o]&&(p=s[o]),c.innerHTML='<p class="ltext">'+o+'</p><p class="star_text" id="l'+o+'_star">'+p+"</p>",i.appendChild(c)}if(t>e)for(var n=e+1;t>=n;n++){var r="lbtn_"+n;document.getElementById(r).className+=" level_btn_active"}},s.StorageSystem=i},{}]},{},[13]);